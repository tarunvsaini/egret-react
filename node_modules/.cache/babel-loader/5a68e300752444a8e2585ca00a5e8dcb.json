{"ast":null,"code":"import _classCallCheck from \"/Users/tarunsaini/Projects/arctic-admin/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/tarunsaini/Projects/arctic-admin/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/Users/tarunsaini/Projects/arctic-admin/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/Users/tarunsaini/Projects/arctic-admin/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nvar _jsxFileName = \"/Users/tarunsaini/Projects/arctic-admin/react/src/app/auth/AuthGuard.jsx\";\nimport React, { Component, Fragment } from \"react\";\nimport { withRouter } from \"react-router-dom\";\nimport { connect } from \"react-redux\";\nimport AppContext from \"app/appContext\";\n\nvar AuthGuard = /*#__PURE__*/function (_Component) {\n  _inherits(AuthGuard, _Component);\n\n  var _super = _createSuper(AuthGuard);\n\n  function AuthGuard(props, context) {\n    var _this;\n\n    _classCallCheck(this, AuthGuard);\n\n    _this = _super.call(this, props);\n    var routes = context.routes;\n    _this.state = {\n      authenticated: true,\n      routes: routes\n    };\n    return _this;\n  }\n\n  _createClass(AuthGuard, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      if (!this.state.authenticated) {\n        this.redirectRoute(this.props);\n      }\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate() {\n      if (!this.state.authenticated) {\n        this.redirectRoute(this.props);\n      }\n    }\n  }, {\n    key: \"shouldComponentUpdate\",\n    value: function shouldComponentUpdate(nextProps, nextState) {\n      return nextState.authenticated !== this.state.authenticated;\n    }\n  }, {\n    key: \"redirectRoute\",\n    value: function redirectRoute(props) {\n      var location = props.location,\n          history = props.history;\n      var pathname = location.pathname;\n      history.push({\n        pathname: \"/session/signin\",\n        state: {\n          redirectUrl: pathname\n        }\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var children = this.props.children;\n      var authenticated = this.state.authenticated; // return <Fragment>{children}</Fragment>;\n\n      return authenticated ? /*#__PURE__*/React.createElement(Fragment, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 63,\n          columnNumber: 28\n        }\n      }, children) : null;\n    }\n  }], [{\n    key: \"getDerivedStateFromProps\",\n    value: function getDerivedStateFromProps(props, state) {\n      var location = props.location,\n          user = props.user;\n      var pathname = location.pathname;\n      var matched = state.routes.find(function (r) {\n        return r.path === pathname;\n      });\n      var authenticated = matched && matched.auth && matched.auth.length ? matched.auth.includes(user.role) : true;\n      return {\n        authenticated: authenticated\n      };\n    }\n  }]);\n\n  return AuthGuard;\n}(Component);\n\nAuthGuard.contextType = AppContext;\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    user: state.user\n  };\n};\n\nexport default withRouter(connect(mapStateToProps)(AuthGuard));","map":{"version":3,"sources":["/Users/tarunsaini/Projects/arctic-admin/react/src/app/auth/AuthGuard.jsx"],"names":["React","Component","Fragment","withRouter","connect","AppContext","AuthGuard","props","context","routes","state","authenticated","redirectRoute","nextProps","nextState","location","history","pathname","push","redirectUrl","children","user","matched","find","r","path","auth","length","includes","role","contextType","mapStateToProps"],"mappings":";;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,QAA3B,QAA2C,OAA3C;AACA,SAASC,UAAT,QAA2B,kBAA3B;AACA,SAASC,OAAT,QAAwB,aAAxB;AACA,OAAOC,UAAP,MAAuB,gBAAvB;;IAEMC,S;;;;;AACJ,qBAAYC,KAAZ,EAAmBC,OAAnB,EAA4B;AAAA;;AAAA;;AAC1B,8BAAMD,KAAN;AACA,QAAME,MAAN,GAAiBD,OAAjB,CAAMC,MAAN;AAEA,UAAKC,KAAL,GAAa;AACXC,MAAAA,aAAa,EAAE,IADJ;AAEXF,MAAAA,MAAM,EAANA;AAFW,KAAb;AAJ0B;AAQ3B;;;;WAED,6BAAoB;AAClB,UAAI,CAAC,KAAKC,KAAL,CAAWC,aAAhB,EAA+B;AAC7B,aAAKC,aAAL,CAAmB,KAAKL,KAAxB;AACD;AACF;;;WAED,8BAAqB;AACnB,UAAI,CAAC,KAAKG,KAAL,CAAWC,aAAhB,EAA+B;AAC7B,aAAKC,aAAL,CAAmB,KAAKL,KAAxB;AACD;AACF;;;WAED,+BAAsBM,SAAtB,EAAiCC,SAAjC,EAA4C;AAC1C,aAAOA,SAAS,CAACH,aAAV,KAA4B,KAAKD,KAAL,CAAWC,aAA9C;AACD;;;WAgBD,uBAAcJ,KAAd,EAAqB;AACnB,UAAQQ,QAAR,GAA8BR,KAA9B,CAAQQ,QAAR;AAAA,UAAkBC,OAAlB,GAA8BT,KAA9B,CAAkBS,OAAlB;AACA,UAAQC,QAAR,GAAqBF,QAArB,CAAQE,QAAR;AAEAD,MAAAA,OAAO,CAACE,IAAR,CAAa;AACXD,QAAAA,QAAQ,EAAE,iBADC;AAEXP,QAAAA,KAAK,EAAE;AAAES,UAAAA,WAAW,EAAEF;AAAf;AAFI,OAAb;AAID;;;WAED,kBAAS;AACP,UAAMG,QAAN,GAAmB,KAAKb,KAAxB,CAAMa,QAAN;AACA,UAAQT,aAAR,GAA0B,KAAKD,KAA/B,CAAQC,aAAR,CAFO,CAIP;;AAEA,aAAOA,aAAa,gBAAG,oBAAC,QAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAWS,QAAX,CAAH,GAAqC,IAAzD;AACD;;;WA/BD,kCAAgCb,KAAhC,EAAuCG,KAAvC,EAA8C;AAC5C,UAAQK,QAAR,GAA2BR,KAA3B,CAAQQ,QAAR;AAAA,UAAkBM,IAAlB,GAA2Bd,KAA3B,CAAkBc,IAAlB;AACA,UAAQJ,QAAR,GAAqBF,QAArB,CAAQE,QAAR;AACA,UAAMK,OAAO,GAAGZ,KAAK,CAACD,MAAN,CAAac,IAAb,CAAkB,UAAAC,CAAC;AAAA,eAAIA,CAAC,CAACC,IAAF,KAAWR,QAAf;AAAA,OAAnB,CAAhB;AACA,UAAMN,aAAa,GACjBW,OAAO,IAAIA,OAAO,CAACI,IAAnB,IAA2BJ,OAAO,CAACI,IAAR,CAAaC,MAAxC,GACIL,OAAO,CAACI,IAAR,CAAaE,QAAb,CAAsBP,IAAI,CAACQ,IAA3B,CADJ,GAEI,IAHN;AAKA,aAAO;AACLlB,QAAAA,aAAa,EAAbA;AADK,OAAP;AAGD;;;;EAvCqBV,S;;AA6DxBK,SAAS,CAACwB,WAAV,GAAwBzB,UAAxB;;AAEA,IAAM0B,eAAe,GAAG,SAAlBA,eAAkB,CAAArB,KAAK;AAAA,SAAK;AAChCW,IAAAA,IAAI,EAAEX,KAAK,CAACW;AADoB,GAAL;AAAA,CAA7B;;AAIA,eAAelB,UAAU,CAACC,OAAO,CAAC2B,eAAD,CAAP,CAAyBzB,SAAzB,CAAD,CAAzB","sourcesContent":["import React, { Component, Fragment } from \"react\";\nimport { withRouter } from \"react-router-dom\";\nimport { connect } from \"react-redux\";\nimport AppContext from \"app/appContext\";\n\nclass AuthGuard extends Component {\n  constructor(props, context) {\n    super(props);\n    let { routes } = context;\n\n    this.state = {\n      authenticated: true,\n      routes\n    };\n  }\n\n  componentDidMount() {\n    if (!this.state.authenticated) {\n      this.redirectRoute(this.props);\n    }\n  }\n\n  componentDidUpdate() {\n    if (!this.state.authenticated) {\n      this.redirectRoute(this.props);\n    }\n  }\n\n  shouldComponentUpdate(nextProps, nextState) {\n    return nextState.authenticated !== this.state.authenticated;\n  }\n\n  static getDerivedStateFromProps(props, state) {\n    const { location, user } = props;\n    const { pathname } = location;\n    const matched = state.routes.find(r => r.path === pathname);\n    const authenticated =\n      matched && matched.auth && matched.auth.length\n        ? matched.auth.includes(user.role)\n        : true;\n\n    return {\n      authenticated\n    };\n  }\n\n  redirectRoute(props) {\n    const { location, history } = props;\n    const { pathname } = location;\n\n    history.push({\n      pathname: \"/session/signin\",\n      state: { redirectUrl: pathname }\n    });\n  }\n\n  render() {\n    let { children } = this.props;\n    const { authenticated } = this.state;\n\n    // return <Fragment>{children}</Fragment>;\n\n    return authenticated ? <Fragment>{children}</Fragment> : null;\n  }\n}\n\nAuthGuard.contextType = AppContext;\n\nconst mapStateToProps = state => ({\n  user: state.user\n});\n\nexport default withRouter(connect(mapStateToProps)(AuthGuard));\n"]},"metadata":{},"sourceType":"module"}